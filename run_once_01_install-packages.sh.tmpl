#!/usr/bin/env bash

set -eufo pipefail

# setup gpakoz tmux
ln -s -f ~/.tmux_runtime/.tmux.conf ~/.tmux.conf

# install antigen for zsh
if [ ! -e "$HOME/antigen.sh" ]; then
	curl -L git.io/antigen > ~/antigen.zsh
fi

# install just
if ! command -v just >/dev/null; then
	curl --proto '=https' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to ~/.local/bin
fi

# setup packer for nvim
if [ ! -d "$HOME/.local/share/nvim/site/pack/packer/start/" ]; then
	# Configure git to use HTTPS instead of SSH for GitHub
	git config --global url."https://github.com/".insteadOf git@github.com:
	
	# Clone packer.nvim with error handling
	mkdir -p ~/.local/share/nvim/site/pack/packer/start/
	git clone --depth 1 https://github.com/wbthomason/packer.nvim ~/.local/share/nvim/site/pack/packer/start/packer.nvim || {
		echo "Warning: Failed to clone packer.nvim, continuing installation..."
		# Don't fail the entire script if packer clone fails
		true
	}
fi
